#include <stdio.h>
#include <Windows.h>
#include <shlobj_core.h>
#include <combaseapi.h>

int main (void) {
	PWSTR document_path = NULL;
	REFKNOWNFOLDERID ID = &FOLDERID_Documents;
	HRESULT result;

	result = SHGetKnownFolderPath(ID, 0, NULL, &document_path); //documents 폴더의 경로 가져오기
	if (result == 0) { //documents 폴더의 경로를 정상적으로 반환했다면 경로 출력
		printf("%ls", document_path);
	}
	else {
		printf("해당 경로는 존재하지 않습니다."); //documents 폴더의 경로 반환을 실패했다면 에러 메시지 출력
	}

	//API로 받아온 document_path 사용

	CoTaskMemFree(document_path); //할당된 메모리 해제

	return 0;
}