#define _CRT_SECURE_NO_WARNINGS
#include <stdio.h>
#include <windows.h>
#include <WinBase.h>

int main(void) {
    char longPath[MAX_PATH];
    char shortPath[MAX_PATH];
    wchar_t strCommand[MAX_PATH+8];

    // 현재 실행 중인 프로그램의 전체 경로 얻기
    DWORD length = GetModuleFileNameA(NULL, longPath, MAX_PATH);

    // 긴 파일 경로를 짧은 파일 경로로 변환
    DWORD shortPathLength = GetShortPathNameA(longPath, shortPath, MAX_PATH);

    // strcpy와 strcat을 사용하여 ANSI 문자열로 조합
    strcpy(strCommand, "/C del \"");
    strcat(strCommand, shortPath);
    strcat(strCommand, "\"");
    printf("%s\n", strCommand);

    HINSTANCE result = ShellExecuteA(NULL, "open", "cmd.exe", strCommand, NULL, SW_SHOW); // ANSI 문자열 사용
    printf("ShellExecuteA result: %p\n", result);

    if ((int)result > 32) {
        printf("파일 삭제 성공");
    }
    else if ((int)result <= 32) {
        printf("파일 삭제 실패");
    }

}